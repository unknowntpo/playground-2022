PG_CONFIG = pg_config
PGXS := $(shell $(PG_CONFIG) --pgxs)
include $(PGXS)

EXTENSION = plannerlog
MODULE_big = plannerlog
OBJS = plannerlog.o

# Add any additional library dependencies here
#LIBS =

# Add any additional include directories here
#CFLAGS += 

all: plannerlog--1.0.sql

plannerlog--1.0.sql: plannerlog--1.0.sql.in
	sed 's/MODULE_big/$(MODULE_big)/' $< > $@

.PHONY: install
install: all
	$(MAKE) -C $(subst share/postgresql,,$(datadir))/extension install
	install --mode 0644 plannerlog.control $(datadir)/extension/
	install --mode 0644 plannerlog--1.0.sql $(datadir)/extension/

.PHONY: clean
clean:
	rm -f plannerlog--1.0.sql
	$(MAKE) -C $(subst share/postgresql,,$(datadir))/extension clean

